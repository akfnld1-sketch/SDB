<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>SD바이오센서 자재팀 출근부 (급여자동계산 V3)</title>

  <!-- ✅ PWA/아이콘 -->
  <link rel="manifest" href="./manifest.json" />
  <meta name="theme-color" content="#0b0f14" />
  <link rel="icon" href="./favicon.ico" />
  <link rel="apple-touch-icon" href="./apple-touch-icon.png" />

  <link rel="stylesheet" href="./styles.css" />
</head>

<body>
  <div class="wrap">
    <header class="top">
      <div>
        <h1>SD바이오센서 자재팀 출근부 <span class="pill">V3</span></h1>
        <div class="sub" id="todayLabel"></div>
      </div>
      <div class="topBtns">
        <button class="btn ghost" id="btnExportCsv" type="button">CSV 내보내기</button>
        <button class="btn ghost" id="btnBackup" type="button">백업(JSON)</button>
        <button class="btn ghost" id="btnRestore" type="button">복원(JSON)</button>
        <input id="fileRestore" type="file" accept="application/json" style="display:none" />
      </div>
    </header>

    <!-- ✅ 달력 (상단 유지) -->
    <section class="card">
      <div class="calHead">
        <div class="calTitle">
          <h2>달력</h2>
          <div class="mini">2026년 1월부터 선택 가능</div>
        </div>
        <div class="calNav">
          <button class="btn ghost" id="btnPrevMonth" type="button">◀</button>
          <div class="calMonth" id="monthLabel"></div>
          <button class="btn ghost" id="btnNextMonth" type="button">▶</button>
        </div>
      </div>

      <div class="dow">
        <div>일</div><div>월</div><div>화</div><div>수</div><div>목</div><div>금</div><div>토</div>
      </div>
      <div id="calendar" class="calendar"></div>
    </section>

    <!-- ✅ 명단 입력을 위로 -->
    <section class="card">
      <div class="cardHead">
        <h2>이름 / 출근부 기록</h2>
        <div class="mini">선택한 날짜에 출근/퇴근/연장/연차/반차 기록</div>
      </div>

      <div class="row">
        <input id="nameInput" class="input" type="text" placeholder="이름 추가 (예: 김OO)" />
        <button class="btn" id="btnAdd" type="button">추가</button>
      </div>

      <div class="hint">
        각 사람마다 “시급/월급”을 입력하면, 출퇴근 기록만으로 예상수당(연장/심야)이 자동 계산됩니다.
      </div>
    </section>

    <!-- ✅ 명단 -->
    <section class="card">
      <div class="cardHead">
        <h2>자재팀 명단 (선택일)</h2>
        <div class="mini" id="statsLabel"></div>
      </div>
      <div id="list" class="list"></div>
    </section>

    <!-- ✅ 기록 로그 -->
    <section class="card">
      <div class="cardHead">
        <h2>기록 로그 (선택일)</h2>
        <div class="mini">최신이 위</div>
      </div>
      <div id="log" class="log"></div>

      <div class="row" style="margin-top:12px;">
        <button class="btn ghost" id="btnUndo" type="button">방금 취소(Undo)</button>
        <button class="btn danger" id="btnResetDay" type="button">이 날짜 기록 초기화</button>
      </div>
    </section>

    <!-- ✅ 급여/설정은 밑으로 내림 + 추가수당 입력 -->
    <section class="card" id="paySection">
      <div class="cardHead">
        <h2>급여 설정 / 추가수당</h2>
        <div class="mini">연장 30분 단위 · 심야 22:00~06:00 · 추가수당은 사용자 입력</div>
      </div>

      <div class="row">
        <div class="field">
          <label>기준 근무시간(일)</label>
          <input id="standardHours" class="input" type="number" min="1" step="0.5" placeholder="예: 8" />
        </div>
        <div class="field">
          <label>연차 시작 일수(연간)</label>
          <input id="annualLeaveStart" class="input" type="number" min="0" step="0.5" placeholder="예: 15" />
        </div>
      </div>

      <div class="row">
        <div class="field">
          <label>연장수당 배수 (OT, 예: 1.5)</label>
          <input id="otMultiplier" class="input" type="number" min="1" step="0.1" placeholder="예: 1.5" />
        </div>
        <div class="field">
          <label>심야 가산(추가 배수) (예: 0.5)</label>
          <input id="nightExtraMultiplier" class="input" type="number" min="0" step="0.1" placeholder="예: 0.5" />
        </div>
        <div class="field">
          <label>연장 30분 끊기 방식</label>
          <select id="otRoundMode" class="input">
            <option value="ceil">올림(추천)</option>
            <option value="floor">내림</option>
            <option value="nearest">반올림</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div class="field">
          <label>월급→시급 환산 기준시간(월)</label>
          <input id="monthlyStdHours" class="input" type="number" min="1" step="1" placeholder="예: 209" />
        </div>
        <div class="field">
          <label>심야 시작 시각</label>
          <input id="nightStart" class="input" type="time" step="60" />
        </div>
        <div class="field">
          <label>심야 종료 시각</label>
          <input id="nightEnd" class="input" type="time" step="60" />
        </div>
      </div>

      <div class="hint" style="margin-bottom:12px;">
        연장시간은 (퇴근-출근) - 기준근무시간으로 계산되며, <b>30분 단위로 자동 끊김</b> 처리됩니다.
        심야시간은 출근~퇴근 구간에서 <b>22:00~06:00</b>에 겹치는 시간이 자동 누적됩니다.
      </div>

      <!-- ✅ 추가수당 입력 (사용자 입력 금액) -->
      <div class="cardHead" style="margin-top:6px;">
        <h2 style="font-size:16px;">추가수당(월 기준/원)</h2>
        <div class="mini">자재/지게차/조장/반장 수당을 급여 대조용으로 합산합니다.</div>
      </div>

      <div class="row">
        <div class="field">
          <label>자재수당 (원)</label>
          <input id="allowMaterial" class="input" type="number" min="0" step="1000" placeholder="예: 50000" />
        </div>
        <div class="field">
          <label>지게차수당 (원)</label>
          <input id="allowForklift" class="input" type="number" min="0" step="1000" placeholder="예: 100000" />
        </div>
      </div>

      <div class="row">
        <div class="field">
          <label>조장수당 (원)</label>
          <input id="allowLeader" class="input" type="number" min="0" step="1000" placeholder="예: 150000" />
        </div>
        <div class="field">
          <label>반장수당 (원)</label>
          <input id="allowDeputy" class="input" type="number" min="0" step="1000" placeholder="예: 200000" />
        </div>
      </div>

      <div class="hint">
        추가수당은 “자동 계산”이 아니라 <b>사용자가 입력한 금액을 합산</b>해서 월 급여 대조(CSV)에 반영됩니다.
      </div>
    </section>

    <footer class="foot">
      <small>서버 없음 · 데이터는 이 기기(브라우저)에만 저장됩니다. · CSV로 급여 대조 가능</small>
    </footer>
  </div>

  <script src="./app.js"></script>
</body>
</html>
